---
product:
    videos:
        limit: {{theme_settings.productpage_videos_count}}
    reviews:
        limit: {{theme_settings.productpage_reviews_count}}
    related_products:
        limit: {{theme_settings.productpage_related_products_count}}
    similar_by_views:
        limit: {{theme_settings.productpage_similar_by_views_count}}
---

{{#partial "page"}}

<main class="page-shell" id="jj-product-page">
  <nav class="breadcrumbs" aria-label="Breadcrumb">
    {{> components/common/breadcrumbs}}
  </nav>

  <article class="product-card">
    <div class="product-layout">

      {{!-- =========================
           GALLERY (real images)
      ========================== --}}
      <section class="product-gallery" aria-label="Product images">
        <div class="gallery-main">
          <button class="img-arrow img-arrow--left" type="button" data-direction="prev" aria-label="Previous image">&#8249;</button>

          {{#if product.main_image}}
            <img
              id="jj-main-image"
              src="{{getImage product.main_image 'zoom'}}"
              alt="{{product.main_image.alt}}"
              data-image-index="0"
            />
          {{else}}
            <img
              id="jj-main-image"
              src="https://via.placeholder.com/900x675/3b6c94/ffffff?text=No+Image"
              alt="{{product.title}}"
              data-image-index="0"
            />
          {{/if}}

          <button class="img-arrow img-arrow--right" type="button" data-direction="next" aria-label="Next image">&#8250;</button>
        </div>

        <div class="gallery-thumbs" aria-label="Thumbnails">
          {{#if product.images}}
            {{#each product.images}}
              <button
                class="gallery-thumb{{#if @first}} is-active{{/if}}"
                type="button"
                data-image-index="{{@index}}"
                data-src="{{getImage this 'zoom'}}"
              >
                <img src="{{getImage this 'thumb'}}" alt="{{this.alt}}">
              </button>
            {{/each}}
          {{else}}
            <button
              class="gallery-thumb is-active"
              type="button"
              data-image-index="0"
              data-src="https://via.placeholder.com/900x675/3b6c94/ffffff?text=No+Image"
            >
              <img src="https://via.placeholder.com/140x140/3b6c94/ffffff?text=No+Image" alt="No image">
            </button>
          {{/if}}
        </div>
      </section>

      {{!-- =========================
           SUMMARY + CONFIG
      ========================== --}}
      <section class="summary-and-config">

        {{!-- Brand + price + title + summary --}}
        <div class="brand-row">
          {{#if product.brand}}
          <div class="brand-chip">
            <span class="brand-chip-logo" aria-hidden="true"></span>
            <a href="{{product.brand.url}}">{{product.brand.name}}</a>
          </div>
          {{/if}}

          <div class="product-price">
            {{> components/products/price price=product.price}}
          </div>
        </div>

        <h1 class="product-title">
          {{product.title}}
        </h1>

        {{#if product.summary}}
        <p class="product-subtitle">
          {{{product.summary}}}
        </p>
        {{/if}}

        {{!-- =========================
             ADD TO CART FORM
        ========================== --}}
        <form
          id="jj-product-form"
          class="jj-product-form"
          method="post"
          action="/cart.php"
          enctype="multipart/form-data"
        >
          <input type="hidden" name="action" value="add">
          <input type="hidden" name="product_id" value="{{product.id}}">
          <input type="hidden" id="jj-qty-input" name="qty[]" value="1">

          {{!-- Options → pills, replacing native UI --}}
          {{#if product.options}}
            {{#each product.options}}
              <div class="config-group" data-option-id="{{id}}">
                <div class="config-header-row">
                  <span class="config-label">{{display_name}}</span>
                  {{#if required}}
                    <span class="config-required" aria-hidden="true">*</span>
                  {{/if}}
                </div>

                <div class="pill-row pill-row--scroll">
                  {{#each values}}
                    <button
                      class="pill{{#if selected}} is-active{{/if}}"
                      type="button"
                      data-option-id="{{../id}}"
                      data-value-id="{{id}}"
                    >
                      {{label}}
                    </button>

                    <input
                      type="radio"
                      class="jj-option-input"
                      name="attribute[{{../id}}]"
                      value="{{id}}"
                      {{#if selected}}checked{{/if}}
                      hidden
                    >
                  {{/each}}
                </div>
              </div>
            {{/each}}
          {{/if}}

          {{!-- QTY + primary add-to-cart --}}
          <div class="qty-row">
            <div class="qty-control">
              <button class="qty-btn" type="button" data-qty-change="-1" aria-label="Decrease quantity">−</button>
              <span class="qty-value" id="jj-qty-display">1</span>
              <button class="qty-btn" type="button" data-qty-change="1" aria-label="Increase quantity">+</button>
            </div>

            <button class="btn-primary" type="submit" id="jj-add-to-cart-main">
              Add to Cart
            </button>
          </div>

          <p class="ship-note">
            Demo text: real availability/shipping messaging for Jiggin’ Johnson’s will go here.
          </p>
        </form>

        {{!-- Best ways to fish it (static for now) --}}
        <div class="rig-block">
          <div class="rig-title">Best ways to fish it (demo)</div>
          <div class="rig-grid">
            <div class="rig-card">
              <strong>Swim Jig Trailer</strong>
              <span>Shallow grass, slow roll</span>
            </div>
            <div class="rig-card">
              <strong>Texas Rig</strong>
              <span>Pitching to cover</span>
            </div>
            <div class="rig-card">
              <strong>Ball Jig Head</strong>
              <span>Dragging sand or rock</span>
            </div>
            <div class="rig-card">
              <strong>Split Shot</strong>
              <span>Natural subtle glides</span>
            </div>
          </div>
        </div>

      </section>
    </div>

    {{!-- =========================
         DETAILS / ACCORDIONS
    ========================== --}}
    <section class="details-shell" aria-label="Details and specs">
      <details open>
        <summary>On-the-water overview (demo copy)</summary>
        <div class="details-body">
          <p>
            This is placeholder text for Jiggin’ Johnson’s new template shell. Once we’re happy with
            the layout and behavior, we’ll plug in real product descriptions, rigging tips, and
            JJ-specific language.
          </p>
        </div>
      </details>

      <details>
        <summary>Specs &amp; build (demo copy)</summary>
        <div class="details-body">
          <p>• Length: sample 2.5" – 3.0"</p>
          <p>• Profile: compact, multi-species soft plastic</p>
          <p>• Material / scent: we’ll customize this per bait</p>
        </div>
      </details>

      <details>
        <summary>Care &amp; storage (demo copy)</summary>
        <div class="details-body">
          <p>
            Store flat in the original bag to preserve shape. Keep dark colors separate to avoid
            bleeding. Compatible with most standard gel scents.
          </p>
        </div>
      </details>
    </section>
  </article>
</main>

{{!-- STICKY MOBILE CART (AJAX-triggered) --}}
<section class="sticky-cart" aria-label="Quick add to cart">
  <div class="sticky-cart__summary">
    <div class="sticky-cart__title">{{product.title}}</div>
    <div class="sticky-cart__meta">
      <span class="sticky-cart__variant">Select options</span>
      <span class="sticky-cart__price">
        {{> components/products/price price=product.price}}
      </span>
    </div>
  </div>
  <button class="sticky-cart__btn" type="button" id="jj-add-to-cart-sticky">
    Add to Cart
  </button>
</section>

{{/partial}}

{{> layout/base}}
